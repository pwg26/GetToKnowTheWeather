<!DOCTYPE html>

<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <title>weatherboi</title>
    <meta name="description" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>

    <body class="backround-home d-flex flex-column h-100">
        <main>
            <section class="container">
                <div class="row">
                    <div class="col-sm-2 mt-4 mb-2 bg-white rounded">
                        <div class="mb-3">

                            <label>Seach City: </label>
                            <input type="text" placeholder="city" id="search" />
                            <button id="saveBtn">search</button>

                        </div>

                        <p>past searches</p>
                        <div id="past-area" class= "d-grid gap-2"></div>



                    </div>





                    <div class="col-sm-10 mt-4 mb-2 bg-white rounded ">
                        <div class="mx-auto">
                            <img id="icon0"></img>
                            <h1 id="city">City:</h1>
                            <p id="t0">temp:</p>
                            <p id="hum0">humidity:</p>
                            <p id="w0">wind:</p>
                            <p id="uv0">uv</p>

                        </div>

                        <div class="row">
                            <div class="col-sm-2 mt-4 mb-2 bg-blue rounded">


                                <img id="icon1"></img>
                                <p id="t1">temp:</p>
                                <p id="hum1">humidity:</p>
                                <p id="w1">wind:</p>
                                <p id="uv1">uv</p>


                            </div>
                            <div class="col-sm-2 mt-4 mb-2 bg-blue rounded">

                                <img id="icon2"></img>
                                <p id="t2">temp:</p>
                                <p id="hum2">humidity:</p>
                                <p id="w2">wind:</p>
                                <p id="uv2">uv</p>


                            </div>
                            <div class="col-sm-2 mt-4 mb-2 bg-blue rounded">

                                <img id="icon3"></img>
                                <p id="t3">temp:</p>
                                <p id="hum3">humidity:</p>
                                <p id="w3">wind:</p>
                                <p id="uv3">uv</p>
                            </div>
                            <div class="col-sm-2 mt-4 mb-2 bg-blue rounded">

                                <img id="icon4"></img>
                                <p id="t4">temp:</p>
                                <p id="hum4">humidity:</p>
                                <p id="w4">wind:</p>
                                <p id="uv4">uv</p>
                            </div>
                            <div class="col-sm-2 mt-4 mb-2 bg-blue rounded">

                                <img id="icon5"></img>
                                <p id="t5">temp:</p>
                                <p id="hum5">humidity:</p>
                                <p id="w5">wind:</p>
                                <p id="uv5">uv</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script type="text/javascript">




            var Locationchange = function (City) {


                var APIkey = "ae4507ac58b609c2c9fb59208a2055d3";

                let queryURL =
                    "https://api.openweathermap.org/data/2.5/weather?" +
                    "q=" + City + "&appid=" +
                    APIkey;

                $.ajax({
                    url: queryURL,
                    method: "GET",
                })
                    // We store all of the retrieved data inside of an object called "response"
                    .then(function (response) {
                        console.log(response)


                        var lat = response.coord.lat
                        var lon = response.coord.lon

                        var APIkey = "ae4507ac58b609c2c9fb59208a2055d3";

                        let queryURL2 = "https://api.openweathermap.org/data/2.5/onecall?lat=" + lat + "&lon=" + lon + "&exclude=hourly" + "&appid=" + APIkey

                        

                        $.ajax({
                            url: queryURL2,
                            method: "GET",
                        })
                            // We store all of the retrieved data inside of an object called "response"
                            .then(function (response2) {
                                
                                // Log the resulting object
                                console.log(response2);

                                $("#city").text("City:" + response.name);
                                $("#uv0").text("UV:" + response2.current.uvi);
                                $("#w0").text("Index:" + response2.current.wind_speed);
                                $("#hum0").text("Humidity:" + response2.current.humidity);
                                $("#t0").text("Temperature(K):" + response2.current.temp);
                                $("#icon0").attr("src", "http://openweathermap.org/img/wn/" + response2.current.weather[0].icon + ".png")

                                // Transfer content to HTML

                                function alldays() {
                                    for (x = 1; x < 6; x++) {

                                        $("#uv" + [x]).text("uv index: " + response2.daily[x].uvi);

                                        $("#w" + [x]).text("Wind Speed: " + response2.daily[x].wind_speed);

                                        $("#hum" + [x]).text("Humidity: " + response2.daily[x].humidity);

                                        $("#t" + [x]).text("Temperature (K) -High: " + response2.daily[x].temp.day);

                                        $("#icon" + [x]).attr("src", "http://openweathermap.org/img/wn/" + response2.daily[x].weather[0].icon + ".png")
                                    }
                                }
                                alldays()



                            

                            })


                    })
                
            }

            function initPast() {
                if (Object.entries(localStorage).length > 0) {
                    for (x = 1; x < (Object.entries(localStorage).length + 1); x++) {
                        var Addedsearches = $("<button>")
                        Addedsearches.text(localStorage.getItem([x]));
                        Addedsearches.addClass("btn btn-primary")
                        Addedsearches.attr("id", [x] + "memory")
                        Addedsearches.attr("location", localStorage.getItem([x]))
                        $(".prev-search").on("click", function () {
                            Locationchange($(this).attr("location"))
                        })
                        $("#past-area").prepend(Addedsearches);
                    }
                }
            }




            pastSearches = []

            $("#saveBtn").on("click", function () {
                var userInput = $("#search").val()
                pastSearches.push(userInput);
                localStorage.setItem((Object.entries(localStorage).length + 1), userInput);
                pastSearches.shift();
                Locationchange(userInput)
            })






            console.log(Object.entries(localStorage).length)

            // for (x = 1; x < pastSearches.length; x++) {
            //     var Addedsearches = $("<div>").text(localStorage.getItem(x));
            //     $("#past-area").prepend(Addedsearches)
            // };
            //     for (x = 1; x < pastSearches.length; x++) {
            //         var Addedsearches = $("<div>").text(localStorage.getItem(x));
            //         $("#past-area").prepend(Addedsearches)



            //     };
            // }
            // appendPastSearch() 





            // function storeCity() {
            //     // TODO: Describe the purpose of the following line of code.
            //     localStorage.setItem("city:", cityText);
            // }
            // // TODO: Describe the purpose of the following line of code.
            // $("#search").on("submit", function(event) {
            //     event.preventDefault();
            //     var cityText = $("#search").value.trim();
            //     // TODO: Describe the functionality of the following `if` statement.
            //     if (cityText === "") {
            //         return;
            //     }
            //     // TODO: Describe the purpose of the following lines of code.

            //     // TODO: What will happen when the following functions are called?
            //     storeCity();

            // });




        </script>

    </body>



</html>